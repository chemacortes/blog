<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Hyperreals *R - Coconut</title><link href="https://blog.ch3m4.org/" rel="alternate"></link><link href="https://blog.ch3m4.org/feeds/coconut.atom.xml" rel="self"></link><id>https://blog.ch3m4.org/</id><updated>2019-05-02T23:58:10+02:00</updated><subtitle>Quarks, bits y otras criaturas infinitesimales</subtitle><entry><title>Coconut - Primeros pasos</title><link href="https://blog.ch3m4.org/2019/05/02/coconut-primeros-pasos/" rel="alternate"></link><published>2019-05-02T01:20:16+02:00</published><updated>2019-05-02T23:58:10+02:00</updated><author><name>Chema Cortés</name></author><id>tag:blog.ch3m4.org,2019-05-02:/2019/05/02/coconut-primeros-pasos/</id><summary type="html">&lt;p&gt;Primera toma de contacto con el lenguaje coconut, su instalación y detalles a tener en cuenta con la compatibilidad con las versiones de python&amp;nbsp;utilizadas.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://coconut-lang.org/" title="Coconut language"&gt;Coconut&lt;/a&gt; es un lenguaje funcional completamente &lt;em&gt;pythónico&lt;/em&gt;. Otro modo de hacer las cosas en python. Al principio puede parecer muy distinto, pero a medida que se conoce te das cuenta de lo útil que es a veces abordar ciertos problemas desde un punto de vista &lt;em&gt;puramente funcional&lt;/em&gt;.&lt;/p&gt;
&lt;h2&gt;Qué versión de python&amp;nbsp;utilizar&lt;/h2&gt;
&lt;p&gt;Antes de empezar con &lt;em&gt;coconut&lt;/em&gt;, una advertencia sobre las versiones de python. Para su ejecución, el código &lt;em&gt;coconut&lt;/em&gt; se traduce en código python, pudiendo elegir qué versión de python ejecutará el código final. Se puede elegir &lt;a href="https://coconut.readthedocs.io/en/master/DOCS.html#allowable-targets"&gt;varias versiones de python&lt;/a&gt; objetivo, independientemente de la versión de python con la que estemos trabajando. Por defecto, se genera &lt;em&gt;&amp;#8220;código universal&amp;#8221;&lt;/em&gt;, válido para todas las versiones de python. Emplear este &lt;em&gt;código universal&lt;/em&gt; requiere renunciar a algunas características de &lt;em&gt;python 3&lt;/em&gt; que no tienen equivalencia en &lt;em&gt;python 2&lt;/em&gt; como es la notación de tipos, el operador &lt;code&gt;'@'&lt;/code&gt; para multiplicación de matrices o las sentencias &lt;code&gt;async&lt;/code&gt; y &lt;code&gt;await&lt;/code&gt; para programación&amp;nbsp;asíncrona.&lt;/p&gt;
&lt;p&gt;En esta serie de artículos sobre &lt;em&gt;coconut&lt;/em&gt; voy a trabajar siempre con una instalación de &lt;em&gt;python 3&lt;/em&gt;, lo recomendado para nuevos proyectos. Así mismo, el código generado se ejecutará en &lt;em&gt;python 3&lt;/em&gt;. Pero transpilar a &lt;em&gt;código universal&lt;/em&gt; debería ser igualmente válido en la mayoría de casos. Es más, ya que todo código &lt;em&gt;python 3&lt;/em&gt; es código válido en &lt;em&gt;coconut&lt;/em&gt;, se podría emplear para convertir código de &lt;em&gt;python 3&lt;/em&gt; a &lt;em&gt;python 2&lt;/em&gt;, aunque no lo&amp;nbsp;recomiendo.&lt;/p&gt;
&lt;p&gt;En la documentación tienes &lt;a href="https://coconut.readthedocs.io/en/master/DOCS.html#compatible-python-versions"&gt;información sobre compatibilidad&lt;/a&gt; de &lt;em&gt;coconut&lt;/em&gt; con algunas versiones de&amp;nbsp;python.&lt;/p&gt;
&lt;h2&gt;Instalación de&amp;nbsp;coconut&lt;/h2&gt;
&lt;p&gt;Para instalar &lt;em&gt;coconut&lt;/em&gt; mi forma preferida es usar &lt;code&gt;conda&lt;/code&gt; empleando el canal &lt;code&gt;conda-forge&lt;/code&gt;. Siempre es recomendable crear un entorno virtual donde aislar las dependencias del resto de nuestra instalación. En concreto, la instalación de &lt;em&gt;coconut&lt;/em&gt; incluye varios kernels de jupyter y una configuración de pygments para el coloreado de&amp;nbsp;sintáxis.&lt;/p&gt;
&lt;p&gt;En particular, prefiero crear un fichero de entorno (&lt;code&gt;environment.yml&lt;/code&gt;) que determine las dependencias, tanto las que instala conda, como las que se necesite instalar con pip. Podríamos concretar con precisión las versiones que vamos a usar; pero me voy a limitar a las dependencias mínimas para la versión que estoy usando ahora, &lt;em&gt;coconut 1.4.0&lt;/em&gt;.&lt;/p&gt;
&lt;figure class='code'&gt;
&lt;figcaption&gt;&lt;span&gt;Entorno virtual &amp;#8216;coco&amp;#8217;&lt;/span&gt; &lt;a href='/code/2019Q2/environment.yml'&gt;download&lt;/a&gt;&lt;/figcaption&gt;

&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;coco&lt;/span&gt;
&lt;span class="nt"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;defaults&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;conda-forge&lt;/span&gt;
&lt;span class="nt"&gt;dependencies&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python=3.6&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;pip&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;coconut&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;mypy&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;pygments&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;jupyter&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;jupyter_console&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;watchdog&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;pyparsing=2.2.0&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;pip&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;cpyparsing&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;/figure&gt;

&lt;p&gt;Se fija la versión de &lt;code&gt;python=3.6&lt;/code&gt; ya que ésta es la versión superior recomendada para &lt;em&gt;coconut&lt;/em&gt;. Posiblemente también funcione correctamente con &lt;code&gt;python=3.7&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Entre las dependencias&amp;nbsp;encontramos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;pygments&lt;/strong&gt;: facilitará el coloreado de sintáxis de código &lt;em&gt;coconut&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;watchdog&lt;/strong&gt;: chequea de cambios en ficheros para automatizar&amp;nbsp;recompilaciones&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;pyparsing&lt;/strong&gt;/&lt;strong&gt;cpyparsing&lt;/strong&gt;: &lt;em&gt;parseo&lt;/em&gt; de texto, utilizado por el traspilador y el interface de línea de comandos. Se fija la versión de &lt;code&gt;pyparsing=2.2.0&lt;/code&gt; ya que daba algunos fallos dentro de &lt;code&gt;jupyter console&lt;/code&gt; con versiones superiores&lt;sup id="fnref-1"&gt;&lt;a class="footnote-ref" href="#fn-1"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;cPyparsing&lt;/code&gt; es una versión optimizada de &lt;code&gt;pyparsing&lt;/code&gt;. Su instalación necesita los compiladores de C apropiados para la creación módulos python para el sistema. Con linux, el entorno que uso, no hay problema; pero es posible que en windows dé errores por no encontrar el compilador &lt;span class="caps"&gt;MS&lt;/span&gt; C++. Si no sabes cómo se instala, siempre puedes quitar &lt;code&gt;cpyparsing&lt;/code&gt; del fichero &lt;code&gt;environment.yml&lt;/code&gt; para que siga usando &lt;code&gt;pyparsing&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Dado que &lt;em&gt;coconut&lt;/em&gt; es un desarrollo muy activo, también recomiendo la instalación de una versión de desarrollo de &lt;em&gt;coconut&lt;/em&gt;. Muchas veces, los problemas encontrados pueden estar resueltos en desarrollo. Pero siempre es interesante probar las novedades que se van a añadiendo y nunca está de más animarse a contribuir en posibles&amp;nbsp;mejoras.&lt;/p&gt;
&lt;p&gt;El entorno de desarrollo estará definio&amp;nbsp;así:&lt;/p&gt;
&lt;figure class='code'&gt;
&lt;figcaption&gt;&lt;span&gt;Entorno virtual &amp;#8216;cocodev&amp;#8217;&lt;/span&gt; &lt;a href='/code/2019Q2/environment-dev.yml'&gt;download&lt;/a&gt;&lt;/figcaption&gt;

&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;cocodev&lt;/span&gt;
&lt;span class="nt"&gt;channels&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;defaults&lt;/span&gt;
&lt;span class="nt"&gt;dependencies&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;python=3&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;pip&lt;/span&gt;
  &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="nt"&gt;pip&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;coconut-develop[dev]&lt;/span&gt;
      &lt;span class="p p-Indicator"&gt;-&lt;/span&gt; &lt;span class="l l-Scalar l-Scalar-Plain"&gt;coconut-prelude&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;/figure&gt;

&lt;p&gt;La instalación de &lt;em&gt;coconut&lt;/em&gt; y sus dependencias para este entorno se delega totalmente en pip. Se añade el módulo &lt;code&gt;coconut-prelude&lt;/code&gt; que nos facilita un mecanismo similar al &lt;code&gt;Prelude&lt;/code&gt; de haskell para tener un entorno configurado con las funciones más habituales en programación&amp;nbsp;funcional.&lt;/p&gt;
&lt;p&gt;Con estos dos ficheros, se crean los entornos&amp;nbsp;virtuales:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ conda env create -f environment.yml
...
$ conda env create -f environment-dev.yml
...
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Primer contacto: Hola&amp;nbsp;Mundo&lt;/h2&gt;
&lt;p&gt;Para ejecutar coconut, se debe activar primero el&amp;nbsp;entorno:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ conda activate coco
$ coconut
Coconut Interpreter:
(type &amp;#39;exit()&amp;#39; or press Ctrl-D to end)
&amp;gt;&amp;gt;&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Sale una interface de línea de comando similar a la que tiene python, incluso se puede introducir código python&amp;nbsp;normal:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="err"&gt;¡&lt;/span&gt;&lt;span class="n"&gt;Hola&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Mundo&lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;En &lt;em&gt;coconut&lt;/em&gt;, éste sería nuestro &lt;em&gt;&amp;#8220;Hola Mundo&amp;#8221;&lt;/em&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;span class="err"&gt;¡&lt;/span&gt;&lt;span class="n"&gt;Hola&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Mundo&lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;El operador &lt;code&gt;|&amp;gt;&lt;/code&gt; puede verse como un &lt;em&gt;pipe&lt;/em&gt; que encadena operaciones, una tras otra, que será de uso común. Se puede describir como una &lt;em&gt;&amp;#8220;aplicación del resultado de la izquierda en la expresión de la derecha&amp;#8221;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Por poner ejemplos de aplicaciones en&amp;nbsp;cadena:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;¡&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;l&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;u&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;span class="err"&gt;¡&lt;/span&gt;&lt;span class="n"&gt;Hola&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Mundo&lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;
&lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Probemos la ejecución de ficheros. Los ficheros de &lt;em&gt;coconut&lt;/em&gt; tienen por extensión &lt;code&gt;.coco&lt;/code&gt;. Creemos un fichero &lt;code&gt;hola.coco&lt;/code&gt; con una única&amp;nbsp;línea:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;¡Hola, Mundo!&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Para&amp;nbsp;ejecutarlo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ coconut --run hola.coco
Compiling         hola.coco ...
Compiled to       hola.py .
¡Hola, Mundo!
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;De la &lt;em&gt;transpilación&lt;/em&gt; se obtiene el fichero &lt;code&gt;hola.py&lt;/code&gt;, que es el que se usa en la ejecución. Se podría volver a ejecutar sin intervención de &lt;em&gt;coconut&lt;/em&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ python hola.py
¡Hola, Mundo!
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Factorial en&amp;nbsp;coconut&lt;/h2&gt;
&lt;p&gt;Como obsesión de este blog está la comparación de formas de hacer el cálculo del factorial. Recomiendo seguir el &lt;a href="https://coconut.readthedocs.io/en/master/HELP.html" title="Tutorial de coconut"&gt;tutorial de coconut&lt;/a&gt; donde se detalla, paso a paso, cómo ir cambiando la formulación de factorial desde estructuras imperativas a&amp;nbsp;funcionales.&lt;/p&gt;
&lt;p&gt;Una formulación simple podría ser&amp;nbsp;esta:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;product&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;factorial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;product&lt;/span&gt;

&lt;span class="mi"&gt;10000&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;factorial&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;print&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Aunque las veremos con detalle más adelante, aquí adelantamos varias características de &lt;em&gt;coconut&lt;/em&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Una función puede devolver una expresión, similar a las funciones &lt;em&gt;lambda&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;La función &lt;code&gt;reduce&lt;/code&gt; está disponible por defecto (importante en programación&amp;nbsp;funcional)&lt;/li&gt;
&lt;li&gt;Se usa el operador multiplicación como &lt;code&gt;(*)&lt;/code&gt; (&lt;em&gt;al estilo haskell&lt;/em&gt;) sin necesidar de importarlo del módulo &lt;code&gt;operator&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Se usa una notación de tipos extendida con &lt;code&gt;int[]&lt;/code&gt; para hacer referencia a una &lt;em&gt;lista de enteros&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La &lt;em&gt;notación de tipos&lt;/em&gt; es en realidad parte de &lt;em&gt;python 3&lt;/em&gt;, lo único que hace &lt;em&gt;coconut&lt;/em&gt; es facilitar su uso con una notación&amp;nbsp;extendida.&lt;/p&gt;
&lt;p&gt;Si es la primera vez que ves &lt;em&gt;programación funcional&lt;/em&gt;, seguramente no entiendas nada. Pronto tendrá todo sentido y te empezarás a preguntar porqué no la conocistes&amp;nbsp;antes.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn-1"&gt;
&lt;p&gt;Este problema también lo tiene la instalación de coconut para &lt;strong&gt;python 2&lt;/strong&gt;. En este caso, la simple ejecución del interface de línea de comando sobra para entrar en un bucle sin fin que agote rápidamente la memoria y bloquee todo el equipo. Forzar la versión a &lt;code&gt;pyparsing=2.2.0&lt;/code&gt; solventa el problema.&amp;#160;&lt;a class="footnote-backref" href="#fnref-1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="coconut"></category><category term="functional-programming"></category><category term="python"></category></entry><entry><title>¿Qué es un coconut?</title><link href="https://blog.ch3m4.org/2019/04/16/que-es-un-coconut/" rel="alternate"></link><published>2019-04-16T00:00:00+02:00</published><updated>2019-04-16T00:51:57+02:00</updated><author><name>Chema Cortés</name></author><id>tag:blog.ch3m4.org,2019-04-16:/2019/04/16/que-es-un-coconut/</id><summary type="html">&lt;p&gt;Inicio de unos artículos dedicados al lenguaje coconut, un lenguaje funcional totalmente &lt;em&gt;pythónico&lt;/em&gt;, y otras novedades para este nuevo reinicio del&amp;nbsp;blog.&lt;/p&gt;</summary><content type="html">&lt;div class="admonition type"&gt;
&lt;p class="admonition-title"&gt;&amp;#8230;and now for something completely&amp;nbsp;different&lt;/p&gt;
&lt;/div&gt;
&lt;h2&gt;Python&amp;nbsp;multiparadigma&lt;/h2&gt;
&lt;p&gt;La primera vez que oí hablar de python allí por finales del siglo pasado, una cosa que me encantó es que se definía como &lt;em&gt;lenguaje multiparadigma&lt;/em&gt; combinandao el clasicismo de los lenguajes imperativos con la novedosa (entonces) &lt;em&gt;orientación a objetos&lt;/em&gt; y con algunas características &lt;em&gt;funcionales&lt;/em&gt; añadidas que lo hacían único. El tiempo ha ido puliendo el lenguaje y la programación funcional se ha ido arrinconando hacia algunos módulos o, directamente, han desaparecido. El propio creador del lenguaje, Guido von Rossum, llegó a pensar en &lt;a href="https://www.artima.com/weblogs/viewpost.jsp?thread=98196" title="The fate of reduce() in Python 3000"&gt;eliminar todo rastro&lt;/a&gt;, aunque finalmente sólo desterró la función &lt;code&gt;reduce&lt;/code&gt; al módulo &lt;code&gt;functools&lt;/code&gt; alegando que no era una característica que entendiera ni usar un programador&amp;nbsp;python.&lt;/p&gt;
&lt;p&gt;Es una pena. La &lt;em&gt;Programación Imperativa&lt;/em&gt; impuesta como único modo de aprender a programar, sin base para cambiar luego hacia los otros dos paradigmas. Cuando se introdujo la &lt;em&gt;Programación Orientada a Objetos&lt;/em&gt; con los interfaces gráficos, se empleó mal. Los objetos fueron tamizados por la programación imperativa para verse como sacos de procedimientos que compartían unas mismas variables de estado. La &lt;em&gt;Programación Funcional&lt;/em&gt;, a pesar de estar presente desde el principio de la historia de la informática, a pesar de ser la que más próxima al pensamiento matemático, quedó fuera del entendimiento de los&amp;nbsp;programadores.&lt;/p&gt;
&lt;p&gt;Pero la tendencia se está inviertiendo. Hoy en día es imprescidible la ejecución concurrente, ya sea para aprovechar las CPUs multinúcleo de nuestros dispositivos, ya sea porque necesitamos atender un alto número de peticiones concurrentes. La programación imperativa ya no es apropiada cuando varios hilos de ejecución se acoplan e interfieren entre sí por los mismos recursos. La programación imperativa se hace menos determinista en estos casos y los fallos son imposibles de repetir de una ejecución a&amp;nbsp;otra.&lt;/p&gt;
&lt;p&gt;La programación funcional, dentro de lo complejo que sea de entender sus premisas a un programador tradicional, es la única que permite razonar lógicamente sobre la ejecución de un programa&amp;nbsp;concurrente.&lt;/p&gt;
&lt;h2&gt;¿Qué es un&amp;nbsp;coconut?&lt;/h2&gt;
&lt;p&gt;Python ha avanzando mucho estos años. Es el principal lenguaje usado en ciencia y enseñanza. Los &lt;em&gt;makers&lt;/em&gt; lo tienen en sus sistemas empotrados como microbit, raspberries pi y similares. Y pronto completará el hito de abandonar la versión 2 para pasar definitivamente a la versión 3, incluyendo entre sus novedades las instrucciones nuevas para la concurrencia y el&amp;nbsp;multiproceso.&lt;/p&gt;
&lt;p&gt;Para mi gusto, a python le falta un sistema de tipos más potente y tener características funcionales. Para lo primero, hay avances con el &lt;em&gt;&amp;#8220;tipado gradual&amp;#8221;&lt;/em&gt;, soportado por varios IDEs que ayuda mucho en la codificación. Para la programación funcional, python cuenta con algunos módulos como &lt;code&gt;itertools&lt;/code&gt; y &lt;code&gt;functools&lt;/code&gt;, pero no deja de ser algo&amp;nbsp;testimonial.&lt;/p&gt;
&lt;p&gt;Pero he descubierto un nuevo lenguaje funcional &lt;em&gt;pythonico&lt;/em&gt;: &lt;a href="http://coconut-lang.org/" title="Coconut Language"&gt;coconut&lt;/a&gt;. Aunque sigo recomendando empezar a programar con un verdadero lenguaje funcional como haskell para evitar adquirir vicios, con coconut se puede tener lo mejor de los dos mundos sin renunciar a usar&amp;nbsp;python.&lt;/p&gt;
&lt;p&gt;Me he animado a aprender coconut e ir creando pequeños artículos a medida que vaya aprendiendo. Intentaré hacer comparaciones con otros lenguajes como haskell, scala o typescript, ya que son los otros lenguajes que estoy empleando frecuentemente, además de&amp;nbsp;python.&lt;/p&gt;
&lt;p&gt;Sobre el nombre de &lt;em&gt;coconut&lt;/em&gt; para un lenguaje &lt;em&gt;pythónico&lt;/em&gt;, hay que recordar que todo lo relativo a &lt;em&gt;python&lt;/em&gt; proviene de las comedias del grupo humorístico &amp;#8220;Monty&amp;nbsp;Python&amp;#8221;:&lt;/p&gt;
&lt;p&gt;&lt;span class="videobox"&gt;
                &lt;iframe width="640" height="390"
                    src='https://www.youtube.com/embed/Fhnjqy8JvEs'
                    frameborder='0' webkitAllowFullScreen mozallowfullscreen
                    allowFullScreen&gt;
                &lt;/iframe&gt;
            &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Pero para los que tenemos ya una edad, &lt;em&gt;coconut&lt;/em&gt; siempre &lt;em&gt;serás tú&lt;/em&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class="videobox"&gt;
                &lt;iframe width="640" height="390"
                    src='https://www.youtube.com/embed/xwFp6THEddE'
                    frameborder='0' webkitAllowFullScreen mozallowfullscreen
                    allowFullScreen&gt;
                &lt;/iframe&gt;
            &lt;/span&gt;&lt;/p&gt;</content><category term="coconut"></category><category term="functional-programming"></category></entry></feed>